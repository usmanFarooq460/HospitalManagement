<page-title [heading]="'Patients'" [icon]="'mdi mdi-account-multiple'"></page-title>

<div class="form">
    <form [formGroup]="formdata">
        <div class="row ml-1">
            <div class="col-md-4 col-6 m-0 p-1">
                <div class="form_group">
                    <label for="Name">Name</label>
                    <input type="text" id="Name" class="form_control" formControlName="Name" placeholder="Name"
                        [ngClass]="{
                        invalid_field: form.Name.invalid && form.Name.touched
                      }" />
                    <div *ngIf="form.Name.invalid && form.Name.touched" class="invalid-feedback d-block">
                        <div *ngIf="form.Name.errors.required" class="invalid-feedback d-block">
                            Required
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3 col-6 m-0 p-1">
                <div class="form_group">
                    <label for="fatherName">Father Name</label>
                    <input type="text" id="fatherName" class="form_control" formControlName="fatherName"
                        placeholder="Father Name" [ngClass]="{
                        invalid_field: form.fatherName.invalid && form.fatherName.touched
                      }" />
                    <div *ngIf="form.fatherName.invalid && form.fatherName.touched" class="invalid-feedback d-block">
                        <div *ngIf="form.fatherName.errors.required" class="invalid-feedback d-block">
                            Required
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3 col-6 m-0 p-1">
                <div class="form_group">
                    <label for="Age">Age</label>
                    <input type="number" id="Age" class="form_control" formControlName="Age" placeholder="Age"
                        [ngClass]="{
                        invalid_field: form.Age.invalid && form.Age.touched
                      }" />
                    <div *ngIf="form.Age.invalid && form.Age.touched" class="invalid-feedback d-block">
                        <div *ngIf="form.Age.errors.required" class="invalid-feedback d-block">
                            Required
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3 col-6 m-0 p-1">
                <div class="form_group">
                    <label for="contactNo">Contact No</label>
                    <input type="text" id="contactNo" class="form_control" formControlName="contactNo"
                        placeholder="Contact No" [ngClass]="{
                        invalid_field: form.contactNo.invalid && form.contactNo.touched
                      }" />
                    <div *ngIf="form.contactNo.invalid && form.contactNo.touched" class="invalid-feedback d-block">
                        <div *ngIf="form.contactNo.errors.required" class="invalid-feedback d-block">
                            Required
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3 col-6 m-0 p-1">
                <div class="form_group">
                    <label for="CNIC_No">CNIC No</label>
                    <input type="text" id="CNIC_No" class="form_control" formControlName="CNIC_No" placeholder="CNIC No"
                        [ngClass]="{
                        invalid_field: form.CNIC_No.invalid && form.CNIC_No.touched
                      }" />
                    <div *ngIf="form.CNIC_No.invalid && form.CNIC_No.touched" class="invalid-feedback d-block">
                        <div *ngIf="form.CNIC_No.errors.required" class="invalid-feedback d-block">
                            Required
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3 col-6 m-0 p-1">
                <div class="form_group">
                    <label for="City">City</label>
                    <input type="text" id="City" class="form_control" formControlName="City" placeholder="City"
                        [ngClass]="{
                            invalid_field: form.City.invalid && form.City.touched
                          }" />
                    <div *ngIf="form.City.invalid && form.City.touched" class="invalid-feedback d-block">
                        <div *ngIf="form.City.errors.required" class="invalid-feedback d-block">
                            Required
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-3 col-6  mr-0 p-1">
                <div class="form_group">
                    <label for="MaritalStatus">Marital Status</label>
                    <select class="form_control" name="MaritalStatus" id="MaritalStatus"
                        formControlName="MaritalStatus">
                        <option value="null">Select Marital Status</option>
                        <option value="{{ item.status }}" *ngFor="let item of maritalStatusList">
                            {{ item.status }}
                        </option>
                    </select>
                </div>
            </div>
            <div class="col-md-3 col-6  mr-0 p-1">
                <div class="form_group">
                    <label for="Gender">Gender</label>
                    <select class="form_control" name="Gender" id="Gender" formControlName="Gender">
                        <option value="null">Select Gender</option>
                        <option value="{{ item.gender }}" *ngFor="let item of GenderList">
                            {{ item.gender }}
                        </option>
                    </select>
                </div>
            </div>
            <div class="col-md-6 col-6 m-0 p-1">
                <div class="form_group">
                    <label for="Address">Address</label>
                    <input type="text" id="Address" class="form_control" formControlName="Address" placeholder="City" />
                </div>
            </div>

        </div>

        <div class="text-right">
            <button style="margin-top: 18px" *ngIf="updateId == null || updateId == undefined" type="submit"
                [disabled]="loaderOn_Save_Update" class="btn blue-color focused-button text-white btn-sm"
                (click)="Save()">
                Save
            </button>
            <button type="submit" style="margin-top: 18px" *ngIf="updateId != null || updateId != undefined"
                [disabled]="loaderOn_Save_Update" class="btn blue-color focused-button text-white btn-sm"
                (click)="update(updateId)">
                Update
            </button>
            <button type="button" style="margin-top: 18px" *ngIf="updateId != null || updateId != undefined"
                class="btn blue-color focused-button text-white btn-sm" (click)="clear()">
                clear
            </button>
        </div>
    </form>


    <div class="search_wrape ">
        <input type="text" placeholder="search" (keyup)="HandleSearchChange($event.target.value)" class="search">
    </div>
    <div class="canvas_view" [ngClass]="{for_no_data:allPatientsHistoryList?.length>0==false}"
        [ngStyle]="{ 'max-height':gridHeight + 'px'}">
        <div class="" *ngIf="allPatientsHistoryList?.length>0==false && isLoading==false">
            No Data Found
        </div>
        <div class="no_data_found_in_canvas" *ngIf="isLoading&&allPatientsHistoryList?.length>0==false">
            <app-loader></app-loader>
        </div>
        <div class="custom_card"
            *ngFor="let item of  allPatientsHistoryList | filterByAllProperties:searchValue; let index=index">
            <div class="header_edit_delete">
                <div class="Header">{{item.Name}}</div>
                <div class="delete_Edit_btns edit-delete-wrape">
                    <div class="edit-icon">
                        <i (click)="getById(item)" class="mdi mdi-grease-pencil cursor_pointer"></i>
                    </div>
                    <div class="delete-icon">
                        <i class="mdi mdi-delete-forever cursor_pointer" (click)="deleteStaff(item._id)"></i>
                    </div>
                </div>
            </div>
            <div class="Card_body">
                <div class="caption_value_wrape">
                    <div class="caption">Father Name</div>
                    <div class="value">{{item.fatherName}}</div>
                </div>
                <div class="caption_value_wrape">
                    <div class="caption">PhoneNo</div>
                    <div class="value">{{item.PhoneNo}}</div>
                </div>
                <div class="caption_value_wrape">
                    <div class="caption">Age</div>
                    <div class="value">{{item.Age}}</div>
                </div>
                <div class="caption_value_wrape">
                    <div class="caption">CNIC_No</div>
                    <div class="value">{{item.CNIC_No|date:'mediumDate'}}</div>
                </div>
                <div class="caption_value_wrape">
                    <div class="caption">City</div>
                    <div class="value">{{item.City}}</div>
                </div>
                <div class="caption_value_wrape">
                    <div class="caption">Contact No</div>
                    <div class="value">{{item.contactNo}}</div>
                </div>
                <div class="caption_value_wrape">
                    <div class="caption">Marital Status</div>
                    <div class="value">{{item.MaritalStatus}}</div>
                </div>
                <div class="caption_value_wrape">
                    <div class="caption">Gender</div>
                    <div class="value">{{item.Gender}}</div>
                </div>
                <div class="caption_value_wrape">
                    <div class="caption">Address</div>
                    <div class="value">{{item.Address}}</div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <app-warning-popups *ngIf="isSucessPopupVisible" [isSuccessPopup]="true" [Message]="message"
                (closePopup)="closeNotification($event)"></app-warning-popups>
            <app-warning-popups *ngIf="isWarningPopupVisible" [isWarningPopup]="true" [Message]="message"
                (closePopup)="closeNotification($event)"></app-warning-popups>
            <app-warning-popups *ngIf="isErrorPopupVisible" [isErrorPopup]="true" [Message]="message"
                (closePopup)="closeNotification($event)"></app-warning-popups>
        </div>
    </div>
</div>